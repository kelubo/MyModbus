# Modbus RTU 设备管理系统 - 使用说明

## ✅ 系统已成功启动！

服务器正在运行：**http://localhost:3000**

---

## 快速开始

### 1. 访问系统

在浏览器中打开：
```
http://localhost:3000
```

### 2. 添加Modbus设备

1. 点击"添加设备"按钮
2. 填写设备信息：
   - **设备名称**：例如"温度传感器"
   - **从站ID**：Modbus从站地址（1-247）
   - **串口**：
     - Windows: `COM1`, `COM2`, `COM3` 等
     - Linux: `/dev/ttyUSB0`, `/dev/ttyS0` 等
   - **波特率**：选择与设备匹配的波特率（常用9600）
   - **寄存器地址**：要读取的寄存器起始地址
   - **寄存器数量**：连续读取的寄存器数量
   - **数据类型**：
     - 保持寄存器（最常用）
     - 输入寄存器
     - 线圈
     - 离散输入
   - **采集间隔**：数据采集周期（毫秒），建议5000以上
   - **启用**：勾选以启用该设备

3. 点击"保存"

### 3. 启动数据采集

1. 确保设备已正确配置
2. 点击页面顶部的"启动采集"按钮
3. 系统将自动开始采集数据

### 4. 查看实时数据

1. 切换到"数据图表"标签页
2. 查看各设备的：
   - 实时数值
   - 更新时间
   - 历史数据曲线（最近50个数据点）

---

## 功能说明

### 设备管理
- ✅ 添加新设备
- ✅ 编辑设备配置
- ✅ 删除设备
- ✅ 启用/禁用设备

### 数据采集
- ✅ 自动定时采集
- ✅ 支持多设备并发采集
- ✅ 实时WebSocket推送
- ✅ 数据持久化存储

### 数据展示
- ✅ 实时数值显示
- ✅ 历史数据曲线
- ✅ 自动刷新图表

---

## 查看可用串口

### Windows系统
1. 按 `Win + X`，选择"设备管理器"
2. 展开"端口(COM和LPT)"
3. 查看可用的COM口

或使用PowerShell命令：
```powershell
Get-WmiObject Win32_SerialPort | Select-Object Name, DeviceID
```

### Linux系统
```bash
ls /dev/tty*
# 或
dmesg | grep tty
```

---

## 常见问题

### Q: 无法读取设备数据？

**检查清单：**
1. 串口号是否正确
2. 波特率是否匹配设备
3. 从站ID是否正确
4. 寄存器地址是否正确
5. 设备是否正确连接
6. 串口是否被其他程序占用

### Q: 串口权限问题（Linux）

```bash
# 添加用户到dialout组
sudo usermod -a -G dialout $USER

# 或临时授权
sudo chmod 666 /dev/ttyUSB0
```

### Q: 如何停止服务器？

在运行服务器的命令行窗口中按 `Ctrl + C`

### Q: 如何修改端口号？

编辑 `server.js` 文件，修改：
```javascript
const PORT = process.env.PORT || 3000;  // 改为其他端口
```

### Q: 数据存储在哪里？

数据存储在项目目录下的 `modbus.db` 文件中

---

## 测试建议

如果暂时没有真实的Modbus设备，可以：

1. **使用Modbus模拟器**
   - Modbus Slave（Windows）
   - pymodbus模拟器（Python）

2. **配置虚拟串口**
   - Windows: com0com
   - Linux: socat

3. **先配置设备信息**
   - 添加设备但不启动采集
   - 测试界面功能

---

## 下一步操作

1. ✅ 服务器已启动
2. 📝 添加你的第一个Modbus设备
3. 🔌 连接真实设备或模拟器
4. 🚀 启动数据采集
5. 📊 查看实时数据图表

---

## 技术支持

- 详细文档：查看 `README.md`
- 快速启动：查看 `START.md`
- 项目地址：当前目录

---

## 停止服务器

在命令行窗口中按 `Ctrl + C` 即可停止服务器。

下次启动只需运行：
```bash
node server.js
```

或使用npm脚本：
```bash
npm start
```
